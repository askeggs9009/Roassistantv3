<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoAssistant - Dashboard</title>
    <link rel="icon" type="image/png" href="/roassistant-logo.png">

    <!-- Organization Structured Data for Google Search -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://roassistantv3-production.up.railway.app",
      "logo": "https://roassistantv3-production.up.railway.app/roassistant-logo.png",
      "name": "RoAssistant",
      "description": "AI-powered Roblox development assistant"
    }
    </script>    <link rel="stylesheet" href="styles/liquid-glass.css">
    <link rel="stylesheet" href="styles/dot-grid.css">


    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/sidebar.css">
    <link rel="stylesheet" href="styles/chat.css">
    <link rel="stylesheet" href="styles/animations.css">
    <link rel="stylesheet" href="styles/responsive.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">


    <style>
        /* Subscription Status Styles */
        .subscription-status {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem 1rem;
            background: rgba(33, 38, 45, 0.6);
            border: 1px solid #30363d;
            border-radius: 8px;
            margin-right: 1rem;
        }

        .plan-badge {
            background: linear-gradient(45deg, #58a6ff, #1f6feb);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .plan-badge.free {
            background: linear-gradient(45deg, #8b949e, #6e7681);
        }

        .plan-badge.pro {
            background: linear-gradient(45deg, #58a6ff, #1f6feb);
        }

        .plan-badge.enterprise {
            background: linear-gradient(45deg, #9d4edd, #7c3aed);
        }

        /* Project Context Styles */
        .project-files-info {
            background: rgba(88, 166, 255, 0.1);
            border: 1px solid rgba(88, 166, 255, 0.2);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        
        .welcome-content a {
            color: #58a6ff;
            text-decoration: none;
        }
        
        .welcome-content a:hover {
            text-decoration: underline;
        }

        .usage-counter {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #8b949e;
            font-size: 0.85rem;
        }

        .usage-bar {
            width: 100px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }

        .usage-fill {
            height: 100%;
            background: linear-gradient(90deg, #58a6ff, #1f6feb);
            transition: width 0.3s ease;
            border-radius: 3px;
        }

        .usage-fill.warning {
            background: linear-gradient(90deg, #d4ac0d, #f39c12);
        }

        .usage-fill.danger {
            background: linear-gradient(90deg, #f85149, #da3633);
        }

        /* Nexus Upgrade Popup Styles - Centered on Screen */
        .nexus-upgrade-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .nexus-popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(4px);
        }

        .nexus-popup-content {
            position: relative;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 16px;
            padding: 2.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
            animation: popupFadeIn 0.3s ease;
            text-align: center;
            z-index: 1;
        }

        @keyframes popupFadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .nexus-popup-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #8b949e;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s ease;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nexus-popup-close:hover {
            background: rgba(248, 81, 73, 0.1);
            color: #f85149;
        }

        .nexus-popup-title {
            color: #f0f6fc;
            margin: 0 0 0.5rem 0;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #58a6ff, #1f6feb);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nexus-popup-price {
            color: #8b949e;
            font-size: 1.1rem;
            margin: 0 0 1.5rem 0;
        }

        .nexus-popup-message {
            color: #c9d1d9;
            margin-bottom: 2rem;
            line-height: 1.5;
            font-size: 0.95rem;
        }

        .nexus-benefits-list {
            margin: 1.5rem 0;
            text-align: left;
        }

        .nexus-benefit-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            color: #c9d1d9;
        }

        .nexus-benefit-item i {
            color: #3fb950;
            font-size: 0.875rem;
            margin-top: 0.125rem;
        }

        .nexus-usage-note {
            color: #6e7681;
            font-size: 0.75rem;
            font-style: italic;
            margin: 1.5rem 0;
        }

        .nexus-popup-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .nexus-btn {
            flex: 1;
            padding: 0.875rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .nexus-btn-primary {
            background: linear-gradient(45deg, #238636, #2ea043);
            color: white;
        }

        .nexus-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 160, 67, 0.5);
        }

        .nexus-btn-secondary {
            background: transparent;
            border: 1px solid #30363d;
            color: #8b949e;
        }

        .nexus-btn-secondary:hover {
            background: rgba(88, 166, 255, 0.1);
            border-color: #58a6ff;
            color: #58a6ff;
        }

        .model-badge {
            color: #8b949e;
            font-size: 0.75rem;
            margin-left: 0.5rem;
        }

        .upgrade-prompt {
            display: none;
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: linear-gradient(135deg, #161b22, #21262d);
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 1.5rem;
            max-width: 350px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: slideInUp 0.3s ease;
        }

        @keyframes slideInUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .upgrade-prompt-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .upgrade-prompt-title {
            font-weight: 600;
            color: #f0f6fc;
        }

        .upgrade-prompt-close {
            background: none;
            border: none;
            color: #8b949e;
            cursor: pointer;
            font-size: 1.5rem;
            line-height: 1;
        }

        .upgrade-prompt-message {
            color: #8b949e;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .upgrade-prompt-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .upgrade-btn {
            flex: 1;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.85rem;
        }

        .upgrade-btn.primary {
            background: linear-gradient(45deg, #238636, #2ea043);
            color: white;
        }

        .upgrade-btn.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(46, 160, 67, 0.4);
        }

        .upgrade-btn.secondary {
            background: transparent;
            border: 1px solid #30363d;
            color: #8b949e;
        }

        .upgrade-btn.secondary:hover {
            border-color: #58a6ff;
            color: #58a6ff;
        }

        .model-locked {
            position: relative;
        }

        .model-locked::after {
            content: '\f023';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.8rem;
        }

        .usage-warning {
            background: rgba(212, 172, 13, 0.1);
            border: 1px solid rgba(212, 172, 13, 0.3);
            border-radius: 8px;
            padding: 0.75rem;
            margin: 1rem;
            color: #d4ac0d;
            font-size: 0.85rem;
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .usage-limit-reached {
            background: rgba(248, 81, 73, 0.1);
            border: 1px solid rgba(248, 81, 73, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem;
            color: #f85149;
            text-align: center;
            display: none;
        }

        /* FIXED: Account switch notification */
        .account-switch-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #58a6ff, #1f6feb);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.4);
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .account-switch-notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        /* Attachment Dropdown Styles */
        .attach-dropdown {
            position: absolute;
            bottom: 45px;
            left: 0;
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            min-width: 160px;
        }

        .attach-option {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background 0.2s ease;
            border-radius: 6px;
            margin: 0.25rem;
        }

        .attach-option:hover {
            background: rgba(88, 166, 255, 0.1);
        }

        .attach-option i {
            width: 16px;
            color: #8b949e;
        }

        .attach-option span {
            color: #f0f6fc;
            font-size: 0.9rem;
        }

        /* Modal Styles */
        .attachment-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
        }

        .modal-content {
            position: relative;
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.5rem 1.5rem 0;
            margin-bottom: 1rem;
        }

        .modal-header h3 {
            color: #f0f6fc;
            margin: 0;
            font-size: 1.25rem;
        }

        .modal-close {
            background: none;
            border: none;
            color: #8b949e;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            background: rgba(248, 81, 73, 0.1);
            color: #f85149;
        }

        .modal-body {
            padding: 0 1.5rem 1rem;
        }

        .modal-body label {
            display: block;
            color: #f0f6fc;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .text-input {
            width: 100%;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 0.75rem;
            color: #f0f6fc;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .text-input:focus {
            outline: none;
            border-color: #58a6ff;
            box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.1);
        }

        .text-textarea {
            width: 100%;
            min-height: 120px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 0.75rem;
            color: #f0f6fc;
            font-size: 0.9rem;
            font-family: 'Monaco', 'Menlo', monospace;
            resize: vertical;
        }

        .text-textarea:focus {
            outline: none;
            border-color: #58a6ff;
            box-shadow: 0 0 0 2px rgba(88, 166, 255, 0.1);
        }

        .modal-footer {
            padding: 1rem 1.5rem 1.5rem;
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-primary {
            background: linear-gradient(45deg, #238636, #2ea043);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(46, 160, 67, 0.4);
        }

        .btn-secondary {
            background: transparent;
            color: #8b949e;
            border: 1px solid #30363d;
        }

        .btn-secondary:hover {
            background: rgba(88, 166, 255, 0.1);
            border-color: #58a6ff;
            color: #58a6ff;
        }

        /* Image Options */
        .image-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .image-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            padding: 1.5rem 1rem;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .image-option:hover {
            background: rgba(88, 166, 255, 0.1);
            border-color: #58a6ff;
        }

        .image-option i {
            font-size: 1.5rem;
            color: #58a6ff;
        }

        .image-option span {
            color: #f0f6fc;
            font-size: 0.9rem;
        }

        .paste-area {
            background: #0d1117;
            border: 2px dashed #30363d;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            color: #8b949e;
            cursor: text;
            transition: all 0.2s ease;
        }

        .paste-area:focus {
            border-color: #58a6ff;
            outline: none;
        }

        .paste-area:hover {
            border-color: #58a6ff;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .image-options {
                grid-template-columns: 1fr;
            }

            .modal-content {
                width: 95%;
                margin: 1rem;
            }
        }
    </style>
</head>

<body>
    <!-- FIXED: Account Switch Notification -->
    <div class="account-switch-notification" id="accountSwitchNotification">
        <div style="display: flex; align-items: center; gap: 0.5rem;">
            <i class="fas fa-sync-alt"></i>
            <span>Account switched! Loading your data...</span>
        </div>
    </div>

    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="roassistant-logo.png" alt="RoAssistant Logo" class="sidebar-logo" style="width: 40px; height: 40px; object-fit: contain;">
            <div class="sidebar-title">RoAssistant</div>
        </div>

        <button class="new-chat-btn" onclick="startNewChat()">
            <span>+</span>
            New chat
        </button>


        <div class="sidebar-nav">
            <!-- Main Navigation -->
            <div class="nav-section">
                <div class="nav-item active" onclick="setActiveNav(this, 'chats')">
                    <span class="nav-icon"><i class="fas fa-comments"></i></span>
                    Chats
                </div>
                <div class="nav-item" onclick="setActiveNav(this, 'projects')">
                    <span class="nav-icon"><i class="fas fa-folder"></i></span>
                    Projects
                </div>
                <div class="nav-item" onclick="setActiveNav(this, 'scripts')">
                    <span class="nav-icon"><i class="fas fa-wrench"></i></span>
                    Scripts
                </div>
                <div class="nav-item authenticated-only" onclick="window.location.href='/account.html'" style="color: #8b949e;">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    Account
                </div>
                <div class="nav-item" onclick="window.location.href='/pricing.html'" style="color: #58a6ff;">
                    <span class="nav-icon"><i class="fas fa-gem"></i></span>
                    Upgrade Plan
                </div>
            </div>

            <!-- Recent Chats -->
            <div class="nav-section">
                <div class="nav-title">Recents</div>
                <div id="chatHistory">
                    <!-- Chat history will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <div class="sidebar-footer">
            <div class="user-profile" id="userProfile">
                <!-- Default Sign In button - will be replaced by JavaScript -->
                <div class="user-avatar"><i class="fas fa-user"></i></div>
                <div class="user-info">
                    <div class="user-name">Guest User</div>
                    <div class="user-plan">Free Plan - <span style="color: #58a6ff; cursor: pointer;" onclick="window.location.href='/login.html'">Sign In for More</span></div>
                </div>
                <button onclick="window.location.href='/login.html'" style="background: #238636; border: none; border-radius: 6px; color: white; padding: 0.4rem 0.8rem; font-size: 0.8rem; cursor: pointer; margin-left: 0.5rem;">
                    Sign In
                </button>
            </div>
        </div>
    </div>

    <!-- Code Panel Overlay -->
    <div class="code-panel-overlay" id="codePanel">
        <div class="code-panel-resize-handle" id="codePanelResizeHandle"></div>
        <div class="code-panel-header">
            <div class="code-panel-title">
                <i class="fas fa-code"></i>
                <span>Code Output</span>
            </div>
            <button class="code-panel-close" onclick="closeCodePanel()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="code-panel-content" id="codePanelContent">
            <!-- Code blocks will be displayed here -->
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Header -->
        <div class="main-header">
            <button class="mobile-menu-btn" id="mobileMenuBtn" onclick="toggleSidebar()">
                ‚ò∞
            </button>
            <div class="header-title" id="chatTitle">New Chat</div>
            
            <!-- Subscription Status -->
            <div class="subscription-status" id="subscriptionStatus" style="display: none;">
                <a href="/account.html" style="text-decoration: none;">
                    <div class="plan-badge" id="planBadge" style="cursor: pointer; transition: transform 0.2s ease;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'" title="View Account Details">Free</div>
                </a>
                <div class="usage-counter">
                    <span id="usageText">0/10</span>
                    <div class="usage-bar">
                        <div class="usage-fill" id="usageFill" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Usage Warning -->
        <div id="usageWarning" class="usage-warning">
            <i class="fas fa-exclamation-triangle"></i> You're approaching your daily message limit. Consider upgrading for unlimited access!
        </div>

        <!-- Usage Limit Reached -->
        <div id="usageLimitReached" class="usage-limit-reached">
            <i class="fas fa-ban"></i> Daily message limit reached. <a href="/pricing.html" style="color: #58a6ff;">Upgrade now</a> for unlimited messages!
        </div>


        <!-- Chat Area -->
        <div class="chat-area">
            <div class="messages-container" id="messagesContainer">
                <!-- Welcome Screen -->
                <div class="welcome-screen stagger-animation" id="welcomeScreen">
                    <div class="welcome-icon"><i class="fas fa-rocket"></i></div>
                    <h1 class="welcome-title" data-text="Welcome to RoAssistant">Welcome to RoAssistant</h1>
                    <p class="welcome-subtitle">Your intelligent assistant for Roblox game development</p>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-container">
                <div class="input-wrapper" id="inputWrapper">
                    <div class="input-content">
                        <!-- File attachments area -->
                        <div class="file-attachments" id="fileAttachments" style="display: none;"></div>
                        
                        <!-- Input row -->
                        <div class="input-row">
                            <button class="attach-button" id="attachButton" onclick="toggleAttachMenu()" title="Add content">
                                <span><i class="fas fa-paperclip"></i></span>
                            </button>

                            <!-- Attachment Options Dropdown -->
                            <div class="attach-dropdown" id="attachDropdown" style="display: none;">
                                <div class="attach-option" onclick="openFileDialog()">
                                    <i class="fas fa-file"></i>
                                    <span>Upload File</span>
                                </div>
                                <div class="attach-option" onclick="openTextModal()">
                                    <i class="fas fa-edit"></i>
                                    <span>Add Text</span>
                                </div>
                                <div class="attach-option" onclick="openImageModal()">
                                    <i class="fas fa-image"></i>
                                    <span>Add Image</span>
                                </div>
                            </div>
                            <button class="model-button" id="modelButton" onclick="toggleModelSelector()" title="Select AI Model">
                                <span><i class="fas fa-sliders-h"></i></span>
                            </button>
                            <!-- Model Selector Dropdown -->
                            <div class="model-dropdown" id="modelDropdown" style="display: none;">
                                <div class="model-dropdown-header">Select Model</div>
                                <div class="model-option selected" data-model="claude-4-sonnet" onclick="selectModel('claude-4-sonnet')">
                                    <div class="model-name">RoCode 3</div>
                                    <i class="fas fa-check model-check"></i>
                                </div>
                                <div class="model-option premium" data-model="claude-4-opus" onclick="selectModel('claude-4-opus')">
                                    <div class="model-name">RoCode Nexus 3</div>
                                    <i class="fas fa-check model-check" style="display: none;"></i>
                                </div>
                            </div>

                            <!-- Token Estimation Display -->
                            <div class="token-estimation" id="tokenEstimation" style="display: none;">
                                <span class="token-icon">üî¢</span>
                                <span class="token-text" id="tokenEstimationText">~0 tokens</span>
                                <span class="token-warning" id="tokenWarning" style="display: none;">‚ö†Ô∏è Exceeds daily limit</span>
                            </div>

                            <textarea
                                class="input-area"
                                id="messageInput"
                                placeholder="Ask me about Roblox scripting, debugging, or game development..."
                                rows="1"
                            ></textarea>
                            <button class="send-button" id="sendButton" onclick="sendMessage()">
                                <span>Send</span>
                            </button>
                        </div>
                    </div>
                </div>
                <input type="file" id="fileInput" accept="image/*,.txt,.lua,.luau,.js,.json,.md" style="display: none;" onchange="handleFileSelect(event)" multiple>

                <!-- Text Content Modal -->
                <div id="textModal" class="attachment-modal" style="display: none;">
                    <div class="modal-overlay" onclick="closeTextModal()"></div>
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Add Text Content</h3>
                            <button class="modal-close" onclick="closeTextModal()">√ó</button>
                        </div>
                        <div class="modal-body">
                            <label for="textTitle">Title (optional):</label>
                            <input type="text" id="textTitle" placeholder="e.g., Code snippet, Notes, etc." class="text-input">

                            <label for="textContent">Content:</label>
                            <textarea id="textContent" placeholder="Paste or type your content here..." class="text-textarea"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeTextModal()">Cancel</button>
                            <button class="btn btn-primary" onclick="addTextContent()">Add Content</button>
                        </div>
                    </div>
                </div>

                <!-- Image Modal -->
                <div id="imageModal" class="attachment-modal" style="display: none;">
                    <div class="modal-overlay" onclick="closeImageModal()"></div>
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Add Image</h3>
                            <button class="modal-close" onclick="closeImageModal()">√ó</button>
                        </div>
                        <div class="modal-body">
                            <div class="image-options">
                                <div class="image-option" onclick="document.getElementById('imageFileInput').click()">
                                    <i class="fas fa-upload"></i>
                                    <span>Upload Image</span>
                                </div>
                                <div class="image-option" onclick="showImageUrlInput()">
                                    <i class="fas fa-link"></i>
                                    <span>Image URL</span>
                                </div>
                                <div class="image-option" onclick="showImagePasteArea()">
                                    <i class="fas fa-clipboard"></i>
                                    <span>Paste Image</span>
                                </div>
                            </div>

                            <input type="file" id="imageFileInput" accept="image/*" style="display: none;" onchange="handleImageFileSelect(event)">

                            <div id="imageUrlInput" style="display: none;">
                                <label for="imageUrl">Image URL:</label>
                                <input type="url" id="imageUrl" placeholder="https://example.com/image.jpg" class="text-input">
                                <button class="btn btn-primary" onclick="addImageFromUrl()">Add Image</button>
                            </div>

                            <div id="imagePasteArea" style="display: none;">
                                <p>Press Ctrl+V to paste an image from clipboard</p>
                                <div class="paste-area" id="pasteArea" contenteditable="true">Click here and paste (Ctrl+V)</div>
                            </div>

                            <div id="imagePreview" style="display: none;">
                                <img id="previewImg" style="max-width: 100%; max-height: 200px; border-radius: 8px;">
                                <p id="imageName"></p>
                                <button class="btn btn-primary" onclick="addImageContent()">Add Image</button>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeImageModal()">Cancel</button>
                        </div>
                    </div>
                </div>

                <!-- Drag & Drop Overlay -->
                <div class="drag-overlay" id="dragOverlay" style="display: none;">
                    <div class="drag-content">
                        <div class="drag-icon"><i class="fas fa-folder-open"></i></div>
                        <div class="drag-text">Drop files here to upload</div>
                        <div class="drag-subtext">Images, code files, and documents</div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Upgrade Prompt -->
    <div class="upgrade-prompt" id="upgradePrompt">
        <div class="upgrade-prompt-header">
            <div class="upgrade-prompt-title"><i class="fas fa-rocket"></i> Unlock More Power</div>
            <button class="upgrade-prompt-close" onclick="closeUpgradePrompt()">√ó</button>
        </div>
        <div class="upgrade-prompt-message" id="upgradePromptMessage">
            You've used 8 of your 10 daily messages. Upgrade to Pro for 500 messages per day!
        </div>
        <div class="upgrade-prompt-buttons">
            <button class="upgrade-btn primary" onclick="window.location.href='/pricing.html'">
                View Plans
            </button>
            <button class="upgrade-btn secondary" onclick="closeUpgradePrompt()">
                Maybe Later
            </button>
        </div>
    </div>

    <script>
        // DYNAMIC API CONFIGURATION - Updated for production deployment
        const getApiBaseUrl = () => {
            // Check if we're running on localhost (development)
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                return 'http://localhost:3000';
            }
            
            // For production, point to Railway backend
            return 'https://roassistantv3-production.up.railway.app';
        };

        const API_BASE_URL = getApiBaseUrl();
        console.log(`[CONFIG] Using API Base URL: ${API_BASE_URL}`);

        // FIXED: Global variables with proper user isolation
        let currentChatId = null;
        let isLoggedIn = false;
        let authToken = null;
        let currentUser = null;
        let selectedModel = 'claude-4-sonnet';
        window.selectedModel = selectedModel;
        let currentView = 'chats';
        let attachedFiles = [];

        // FIXED: User-specific data storage
        let userChats = [];
        let userScripts = [];

        // Subscription management
        let userSubscription = {
            plan: 'free',
            limits: {
                daily_messages: 10,
                models: ['gpt-4o-mini']
            },
            usage: {
                daily_messages: 0,
                daily_limit: 10
            }
        };


        // FIXED: Account switching functionality
        class AccountManager {
            constructor() {
                this.lastKnownUser = null;
                this.initializeWatcher();
            }

            initializeWatcher() {
                // Watch for auth token changes
                const originalSetItem = localStorage.setItem;
                const originalRemoveItem = localStorage.removeItem;
                
                localStorage.setItem = (key, value) => {
                    if (key === 'authToken' || key === 'user') {
                        setTimeout(() => this.checkForAccountSwitch(), 100);
                    }
                    return originalSetItem.call(localStorage, key, value);
                };
                
                localStorage.removeItem = (key) => {
                    if (key === 'authToken' || key === 'user') {
                        setTimeout(() => this.checkForAccountSwitch(), 100);
                    }
                    return originalRemoveItem.call(localStorage, key);
                };
            }

            checkForAccountSwitch() {
                const currentToken = localStorage.getItem('authToken');
                const currentUserData = localStorage.getItem('user');
                
                let currentUserId = null;
                if (currentUserData) {
                    try {
                        const user = JSON.parse(currentUserData);
                        currentUserId = user.id || user.email;
                    } catch (error) {
                        console.error('Error parsing user data:', error);
                    }
                }

                // Check if user has switched
                if (this.lastKnownUser !== currentUserId) {
                    console.log('[ACCOUNT] User switch detected:', this.lastKnownUser, '->', currentUserId);
                    this.handleAccountSwitch(currentUserId);
                    this.lastKnownUser = currentUserId;
                }
            }
        }


        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing app...');
            initApp();
            
            // Check subscription status and refresh periodically
            checkSubscriptionStatus();
            setInterval(checkSubscriptionStatus, 60000); // Refresh every minute
        });

        // Check for project parameter in URL
        function checkProjectParameter() {
            const urlParams = new URLSearchParams(window.location.search);
            const projectId = urlParams.get('project');
            
            if (projectId) {
                // Load project context if needed
                console.log('Loading project context:', projectId);
                // You can implement project-specific logic here
            }
        }


        // Authentication and User Profile Functions
        function checkAuth() {
            console.log('Checking auth...');
            authToken = localStorage.getItem('authToken');
            const user = localStorage.getItem('user');

            if (authToken && user) {
                try {
                    const userData = JSON.parse(user);
                    currentUser = userData;
                    showLoggedInUser(userData);
                    isLoggedIn = true;
                } catch (error) {
                    console.error('Error parsing user data:', error);
                    showGuestUser();
                    isLoggedIn = false;
                    currentUser = null;
                }
            } else {
                showGuestUser();
                isLoggedIn = false;
                currentUser = null;
            }
            updateModelSelector();
        }

        // Show logged in user profile
        function showLoggedInUser(userData) {
            const userProfile = document.getElementById('userProfile');
            if (userProfile) {
                const planText = userData.subscription?.plan || 'free';
                const planDisplay = planText.charAt(0).toUpperCase() + planText.slice(1);
                
                userProfile.innerHTML = `
                    <div class="user-avatar">${(userData.name || userData.email || 'U').charAt(0).toUpperCase()}</div>
                    <div class="user-info">
                        <div class="user-name">${userData.name || userData.email || 'User'}</div>
                        <div class="user-plan">${planDisplay} Plan</div>
                    </div>
                    <button onclick="logout()" style="background: #f85149; border: none; border-radius: 6px; color: white; padding: 0.4rem 0.8rem; font-size: 0.8rem; cursor: pointer; margin-left: 0.5rem;">
                        Logout
                    </button>
                `;
            }
        }

        // Show guest user profile
        function showGuestUser() {
            console.log('[AUTH] Showing guest user profile...');
            const userProfile = document.getElementById('userProfile');
            if (userProfile) {
                userProfile.innerHTML = `
                    <div class="user-avatar"><i class="fas fa-user"></i></div>
                    <div class="user-info">
                        <div class="user-name">Guest User</div>
                        <div class="user-plan">Free Plan - <span style="color: #58a6ff; cursor: pointer;" onclick="window.location.href='/login.html'">Sign In for More</span></div>
                    </div>
                    <button onclick="window.location.href='/login.html'" style="background: #238636; border: none; border-radius: 6px; color: white; padding: 0.4rem 0.8rem; font-size: 0.8rem; cursor: pointer; margin-left: 0.5rem;">
                        Sign In
                    </button>
                `;
                console.log('[AUTH] Guest user profile updated successfully');
            } else {
                console.error('[AUTH] Could not find userProfile element!');
            }
        }

        // Logout function (redirect to authManager if available)
        function logout() {
            if (window.authManager) {
                window.authManager.logout();
            } else {
                // Fallback if authManager isn't loaded
                localStorage.removeItem('authToken');
                localStorage.removeItem('user');

                // Reset state variables
                isLoggedIn = false;
                authToken = null;
                currentUser = null;

                // Show guest user interface
                showGuestUser();
                updateModelSelector();
            }
        }

        // Toggle model selector dropdown
        function toggleModelSelector() {
            const dropdown = document.getElementById('modelDropdown');
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }

        // Streaming functionality - enabled by default
        let streamingEnabled = true;
        window.streamingEnabled = true; // Make it available globally

        // Select a model
        function selectModel(model) {
            const newModel = model;
            console.log('Model changed to:', newModel);

            // Update selected state in dropdown
            document.querySelectorAll('.model-option').forEach(option => {
                option.classList.remove('selected');
                const check = option.querySelector('.model-check');
                if (check) {
                    check.style.display = 'none';
                }
            });

            const selectedOption = document.querySelector(`.model-option[data-model="${model}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
                const check = selectedOption.querySelector('.model-check');
                if (check) {
                    check.style.display = 'block';
                }
            }

            // If the model actually changed, start a new chat
            if (newModel !== selectedModel) {
                selectedModel = newModel;
                window.selectedModel = selectedModel;

                // Update button icon to show current model
                updateModelButton();

                // Start a new chat when model changes
                startNewChat();

                // Show a message indicating the model change
                const modelName = model === 'claude-4-opus' ? 'RoCode Nexus 3' : 'RoCode 3';
                if (window.chatManager) {
                    window.chatManager.addMessage('system', `<i class="fas fa-sync-alt"></i> Switched to ${modelName}. Starting a new conversation.`);
                }
            }

            // Hide dropdown
            document.getElementById('modelDropdown').style.display = 'none';
        }

        // Update model button to show current selection
        function updateModelButton() {
            const modelButton = document.getElementById('modelButton');
            if (modelButton) {
                // Update title to show current model
                const modelName = selectedModel === 'claude-4-opus' ? 'RoCode Nexus 3' : 'RoCode 3';
                modelButton.title = `Current Model: ${modelName}`;
            }
        }


        // Update model selector for auth status
        function updateModelSelector() {
            // Update the premium model option based on auth status
            const premiumOption = document.querySelector('.model-option.premium');
            if (premiumOption && !isLoggedIn) {
                premiumOption.classList.add('disabled');
            } else if (premiumOption) {
                premiumOption.classList.remove('disabled');
            }
            updateModelButton();
        }

        // Initialize app
        function initApp() {
            console.log('Initializing app...');
            // Don't call local checkAuth here - let authManager handle it
            // checkAuth();
        }

        // Check subscription status (stub for now)
        function checkSubscriptionStatus() {
            // This function would normally check subscription status from server
            console.log('Checking subscription status...');
        }

        // Enhanced attachment functionality
        function toggleAttachMenu() {
            const dropdown = document.getElementById('attachDropdown');
            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
        }

        // Text content modal functions
        function openTextModal() {
            document.getElementById('attachDropdown').style.display = 'none';
            document.getElementById('textModal').style.display = 'flex';
            document.getElementById('textTitle').focus();
        }

        function closeTextModal() {
            document.getElementById('textModal').style.display = 'none';
            document.getElementById('textTitle').value = '';
            document.getElementById('textContent').value = '';
        }

        function addTextContent() {
            const title = document.getElementById('textTitle').value.trim();
            const content = document.getElementById('textContent').value.trim();

            if (!content) {
                alert('Please enter some content');
                return;
            }

            // Create a text "file" attachment
            const textFile = new Blob([content], { type: 'text/plain' });
            const fileName = title || 'text-content.txt';

            // Create a File object from the blob
            const file = new File([textFile], fileName, { type: 'text/plain' });

            // Add to attached files
            if (!window.chatManager.attachedFiles) {
                window.chatManager.attachedFiles = [];
            }
            window.chatManager.attachedFiles.push(file);

            // Show in file attachments
            showFileAttachment(file, window.chatManager.attachedFiles.length - 1);

            closeTextModal();
        }

        // Image modal functions
        function openImageModal() {
            document.getElementById('attachDropdown').style.display = 'none';
            document.getElementById('imageModal').style.display = 'flex';
            resetImageModal();
        }

        function closeImageModal() {
            document.getElementById('imageModal').style.display = 'none';
            resetImageModal();
        }

        function resetImageModal() {
            document.getElementById('imageUrlInput').style.display = 'none';
            document.getElementById('imagePasteArea').style.display = 'none';
            document.getElementById('imagePreview').style.display = 'none';
            document.getElementById('imageUrl').value = '';
        }

        function showImageUrlInput() {
            resetImageModal();
            document.getElementById('imageUrlInput').style.display = 'block';
            document.getElementById('imageUrl').focus();
        }

        function showImagePasteArea() {
            resetImageModal();
            document.getElementById('imagePasteArea').style.display = 'block';

            const pasteArea = document.getElementById('pasteArea');
            pasteArea.focus();

            // Add paste event listener
            pasteArea.addEventListener('paste', handleImagePaste, { once: true });
        }

        function handleImagePaste(event) {
            event.preventDefault();
            const items = event.clipboardData.items;

            for (let item of items) {
                if (item.type.indexOf('image') !== -1) {
                    const blob = item.getAsFile();
                    if (blob) {
                        showImagePreview(blob, 'pasted-image.png');
                        return;
                    }
                }
            }

            alert('No image found in clipboard. Please copy an image first.');
        }

        function addImageFromUrl() {
            const url = document.getElementById('imageUrl').value.trim();
            if (!url) {
                alert('Please enter a valid image URL');
                return;
            }

            // Validate URL format
            try {
                new URL(url);
            } catch {
                alert('Please enter a valid URL');
                return;
            }

            // Show preview
            const img = document.getElementById('previewImg');
            img.src = url;
            img.onload = () => {
                document.getElementById('imageName').textContent = url.split('/').pop() || 'image-from-url';
                document.getElementById('imageUrlInput').style.display = 'none';
                document.getElementById('imagePreview').style.display = 'block';

                // Store the URL for later use
                img.dataset.imageUrl = url;
            };
            img.onerror = () => {
                alert('Failed to load image from URL. Please check the URL and try again.');
            };
        }

        function handleImageFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                showImagePreview(file, file.name);
            }
        }

        function showImagePreview(file, name) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = document.getElementById('previewImg');
                img.src = e.target.result;
                img.dataset.imageFile = ''; // Mark as file
                document.getElementById('imageName').textContent = name;
                document.getElementById('imagePreview').style.display = 'block';

                // Store the file for later use
                img.dataset.imageBlob = file;
            };
            reader.readAsDataURL(file);
        }

        function addImageContent() {
            const img = document.getElementById('previewImg');
            const imageName = document.getElementById('imageName').textContent;

            if (img.dataset.imageUrl) {
                // Handle URL image - create a text file with the URL
                const urlContent = `Image URL: ${img.dataset.imageUrl}`;
                const textFile = new Blob([urlContent], { type: 'text/plain' });
                const file = new File([textFile], `${imageName}-url.txt`, { type: 'text/plain' });

                if (!window.chatManager.attachedFiles) {
                    window.chatManager.attachedFiles = [];
                }
                window.chatManager.attachedFiles.push(file);
                showFileAttachment(file, window.chatManager.attachedFiles.length - 1);
            } else if (img.dataset.imageBlob) {
                // Handle file image
                const file = img.dataset.imageBlob;

                if (!window.chatManager.attachedFiles) {
                    window.chatManager.attachedFiles = [];
                }
                window.chatManager.attachedFiles.push(file);
                showFileAttachment(file, window.chatManager.attachedFiles.length - 1);
            }

            closeImageModal();
        }

        function showFileAttachment(file, index) {
            const fileAttachments = document.getElementById('fileAttachments');

            // Create file preview
            const filePreview = document.createElement('div');
            filePreview.className = 'file-attachment';
            filePreview.innerHTML = `
                <div class="file-info">
                    <span class="file-name">${file.name}</span>
                    <span class="file-size">${formatFileSize(file.size)}</span>
                </div>
                <button class="remove-file" onclick="removeFile(${index})">√ó</button>
            `;

            fileAttachments.appendChild(filePreview);
            fileAttachments.style.display = 'block';
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            const attachButton = document.getElementById('attachButton');
            const attachDropdown = document.getElementById('attachDropdown');

            if (!attachButton.contains(event.target) && !attachDropdown.contains(event.target)) {
                attachDropdown.style.display = 'none';
            }
        });

        // Close modals with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeTextModal();
                closeImageModal();
                closeCodePanel();
            }
        });

        // Close code panel function
        function closeCodePanel() {
            const codePanel = document.getElementById('codePanel');
            const mainContent = document.getElementById('mainContent');

            if (codePanel) {
                codePanel.classList.remove('active');
            }
            if (mainContent) {
                mainContent.classList.remove('code-panel-active');
            }
        }

        // Make closeCodePanel globally available
        window.closeCodePanel = closeCodePanel;
    </script>

    <!-- Load JavaScript modules -->
    <script src="js/storage-utils.js"></script>
    <script src="js/sync-manager.js"></script>
    <script src="js/sync-ui.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/chat.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/scripts.js"></script>
    <script src="js/micro-interactions.js"></script>    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>


    <!-- ReactBits-Inspired Animations -->
    <script src="js/animations/dot-grid-background.js"></script>
    <script src="js/animations/blur-text.js"></script>
    <script src="js/animations/micro-interactions.js"></script>
    <script src="js/animations/animations-init.js"></script>

    <script src="js/app.js"></script>

    <!-- Initialize the application -->
    <script>
        // Initialize app when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            const app = new App();
            app.init();

            // Add click outside listener for model dropdown
            document.addEventListener('click', function(e) {
                const modelDropdown = document.getElementById('modelDropdown');
                const modelButton = document.getElementById('modelButton');

                if (modelDropdown && modelButton) {
                    if (!modelButton.contains(e.target) && !modelDropdown.contains(e.target)) {
                        modelDropdown.style.display = 'none';
                    }
                }
            });

            // Initialize model button
            updateModelButton();

            // Setup token estimation for message input
            setupTokenEstimation();
        });

        // Token estimation functionality
        let estimationTimeout;
        let lastEstimation = null;

        function setupTokenEstimation() {
            const messageInput = document.getElementById('messageInput');
            if (messageInput) {
                messageInput.addEventListener('input', debounceTokenEstimation);
                messageInput.addEventListener('keyup', debounceTokenEstimation);
            }
        }

        function debounceTokenEstimation() {
            clearTimeout(estimationTimeout);
            estimationTimeout = setTimeout(() => {
                updateTokenEstimation();
            }, 500); // Wait 500ms after user stops typing
        }

        async function updateTokenEstimation() {
            const messageInput = document.getElementById('messageInput');
            const tokenEstimation = document.getElementById('tokenEstimation');
            const tokenEstimationText = document.getElementById('tokenEstimationText');
            const tokenWarning = document.getElementById('tokenWarning');

            if (!messageInput || !tokenEstimation) return;

            const prompt = messageInput.value.trim();

            if (prompt.length === 0) {
                tokenEstimation.style.display = 'none';
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/api/estimate-tokens`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': authToken ? `Bearer ${authToken}` : ''
                    },
                    body: JSON.stringify({
                        prompt: prompt,
                        model: selectedModel
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    lastEstimation = data.estimation;

                    // Show estimation
                    tokenEstimation.style.display = 'flex';

                    // Format display based on confidence level
                    const confidenceSymbol = data.estimation.confidence === 'high' ? '' :
                                            data.estimation.confidence === 'medium' ? '‚âà' : '~';
                    tokenEstimationText.textContent = `${confidenceSymbol}${data.estimation.estimatedTotal.toLocaleString()} tokens`;

                    // Reset classes
                    tokenEstimation.classList.remove('warning', 'error');
                    tokenWarning.style.display = 'none';

                    // Check for warnings if user is authenticated and has limits
                    if (data.userContext && data.userContext.wouldExceedLimit) {
                        tokenEstimation.classList.add('error');
                        tokenWarning.style.display = 'inline';
                        tokenWarning.textContent = '‚ö†Ô∏è Exceeds daily limit';
                    } else if (data.userContext && data.userContext.remainingTokens < data.estimation.estimatedTotal * 2) {
                        tokenEstimation.classList.add('warning');
                    }

                } else {
                    console.error('Token estimation failed:', response.statusText);
                }
            } catch (error) {
                console.error('Token estimation error:', error);
            }
        }

        // Update the chat manager to show estimation results
        if (window.chatManager) {
            const originalUpdateUsageDisplay = window.chatManager.updateUsageDisplay;
            window.chatManager.updateUsageDisplay = function(usageInfo) {
                originalUpdateUsageDisplay.call(this, usageInfo);

                // Log estimation accuracy if available
                if (usageInfo && usageInfo.tokenEstimation && lastEstimation) {
                    console.log(`[TOKEN ESTIMATION] Accuracy: ${usageInfo.tokenEstimation.actualAccuracy}% (estimated: ${lastEstimation.estimatedTotal}, actual: ${usageInfo.tokenUsage.totalTokens})`);
                }
            };
        }

    </script>

    <!-- Nexus Limit Upgrade Popup - Full Screen Overlay -->
    <div id="nexusUpgradeModal" class="nexus-upgrade-popup" style="display: none;">
        <div class="nexus-popup-overlay" onclick="closeUpgradeModal()"></div>
        <div class="nexus-popup-content">
            <button class="nexus-popup-close" onclick="closeUpgradeModal()">&times;</button>
            <h1 class="nexus-popup-title">RoAssistant Pro</h1>
            <p class="nexus-popup-price">$10/month</p>
            <p class="nexus-popup-message">Daily RoCode Nexus 3 limit reached (3). Upgrade to Pro for unlimited access.</p>

            <div class="nexus-benefits-list">
                <div class="nexus-benefit-item">
                    <i class="fas fa-check"></i>
                    <span>More RoCode Nexus 3 usage*</span>
                </div>
                <div class="nexus-benefit-item">
                    <i class="fas fa-check"></i>
                    <span>Access to unlimited Projects to organize chats</span>
                </div>
                <div class="nexus-benefit-item">
                    <i class="fas fa-check"></i>
                    <span>Priority support and faster responses</span>
                </div>
                <div class="nexus-benefit-item">
                    <i class="fas fa-check"></i>
                    <span>Extended context for complex work</span>
                </div>
                <div class="nexus-benefit-item">
                    <i class="fas fa-check"></i>
                    <span>Advanced Roblox development features</span>
                </div>
                <div class="nexus-benefit-item">
                    <i class="fas fa-check"></i>
                    <span>Access to RoCode Studio (Enterprise)</span>
                </div>
            </div>

            <p class="nexus-usage-note">*Usage limits apply</p>

            <div class="nexus-popup-buttons">
                <button class="nexus-btn nexus-btn-secondary" onclick="closeUpgradeModal(); selectModel('claude-4-sonnet');">Switch to RoCode 3</button>
                <button class="nexus-btn nexus-btn-primary" onclick="window.location.href='/pricing.html'">Buy</button>
            </div>
        </div>
    </div>

</body>
</html>
